---
title: "샌드박스·컨테이너 격리"
date: "2025-07-07"
tags: ["Agentic AI", "보안", "샌드박스", "컨테이너"]
difficulty: "medium"
---

# 샌드박스·컨테이너 격리 (Sandbox & Container Isolation)

## 1. 핵심 개념 (Core Concept)

샌드박싱과 컨테이너 격리는 AI 에이전트가 실행하는 코드나 프로세스를 호스트 시스템 및 다른 애플리케이션으로부터 분리하는 핵심 보안 기술입니다. 이를 통해 악의적인 코드 실행, 시스템 리소스 무단 접근, 데이터 유출 등의 위협을 방지하고 에이전트의 행동 범위를 안전하게 제어하여 신뢰성을 확보합니다.

---

## 2. 상세 설명 (Detailed Explanation)

AI 에이전트는 자율적으로 코드를 생성 및 실행하고, 외부 시스템과 상호작용하는 등 예측하기 어려운 동작을 수행할 수 있어 잠재적인 보안 위협이 존재합니다. 격리 기술은 이러한 위협을 통제하기 위한 필수적인 방어 메커니즘입니다.

### 2.1 샌드박싱 (Sandboxing)

샌드박싱은 애플리케이션을 제한된 가상 환경 내에서 실행하는 기법입니다. 운영체제 수준에서 특정 시스템 콜, 파일 접근, 네트워크 통신 등을 엄격하게 제어하여 애플리케이션에 할당된 권한을 최소화합니다 (최소 권한 원칙).

*   **작동 방식**: 허용된 작업 목록(Allowlist) 또는 금지된 작업 목록(Denylist)을 기반으로 프로세스의 행동을 감시하고 제한합니다.
*   **장점**: 비교적 가볍고, 특정 목적에 맞게 유연하게 보안 정책을 적용하기 용이합니다.
*   **AI 에이전트 적용**: 에이전트가 생성한 코드를 실행할 때, 파일 시스템의 특정 경로에만 접근을 허용하거나, 지정된 API 엔드포인트 외의 네트워크 연결은 차단하는 등의 규칙을 적용할 수 있습니다.

### 2.2 컨테이너 격리 (Container Isolation)

컨테이너 기술(예: Docker)은 애플리케이션을 그 종속성(라이브러리, 설정 파일 등)과 함께 패키징하여 격리된 환경을 제공합니다. 컨테이너는 호스트 시스템의 커널을 공유하지만, 자체적인 파일 시스템, 네트워크 인터페이스, 프로세스 공간을 가집니다.

*   **핵심 기술**: 리눅스의 `namespaces` (자원 격리)와 `cgroups` (자원 제어)를 기반으로 동작합니다.
*   **장점**: 샌드박스보다 더 높은 수준의 격리를 제공하며, 환경의 일관성과 재현성을 보장하여 배포를 용이하게 합니다.
*   **AI 에이전트 적용**: 각 에이전트 세션을 별도의 컨테이너에서 실행하여, 한 에이전트의 작업이 다른 에이전트나 호스트 시스템에 영향을 미치는 것을 원천적으로 차단합니다. 예를 들어, 코드 실행 에이전트가 악성 코드를 다운로드하더라도 그 영향은 해당 컨테이너 내부로 국한됩니다.

### 2.3 샌드박스 vs. 컨테이너

| 구분 | 샌드박싱 (Sandboxing) | 컨테이너 격리 (Container Isolation) |
| :--- | :--- | :--- |
| **격리 수준** | 프로세스 수준 (시스템 콜, API 제어) | 시스템 수준 (파일 시스템, 네트워크, 프로세스) |
| **주요 목적** | 특정 행위 제한 및 감시 | 환경 전체의 격리 및 패키징 |
| **자원 오버헤드** | 낮음 | 비교적 높음 (컨테이너 이미지 필요) |
| **대표 기술** | AppArmor, seccomp, gVisor | Docker, Podman, LXC |

---

## 3. 예시 (Example)

### 코드 예시 (Python with E2B)

[E2B](https://e2b.dev/)는 AI 에이전트를 위한 오픈소스 샌드박스 환경을 제공하는 도구입니다. 내부적으로 Firecracker 마이크로-VM을 사용하여 강력한 격리를 보장합니다.

```python
# E2B SDK를 사용한 에이전트 샌드박싱 예시
from e2b import Sandbox

def run_code_in_sandbox(code: str):
    # 샌드박스 환경 생성 (필요시 특정 템플릿 사용 가능)
    # 격리된 파일 시스템과 네트워크 환경을 가짐
    with Sandbox(template="base") as sandbox:
        # 샌드박스 내에서 사용자 코드 실행
        process = sandbox.process.start(f"python -c '{code}'")
        process.wait()

        # 실행 결과 반환
        return process.stdout, process.stderr

# 안전하지 않은 코드를 샌드박스 내에서 실행
user_code = "import os; os.system('ls -la /')"
stdout, stderr = run_code_in_sandbox(user_code)

print("--- Sandbox Output ---")
print(stdout)
print("--- Sandbox Error ---")
print(stderr)
```

### 사용 사례 (Use Case)

*   **코드 생성 및 실행 에이전트**: GitHub Copilot Workspace나 OpenDevin과 같은 에이전트는 사용자 요청에 따라 코드를 생성하고 테스트를 실행합니다. 이때 컨테이너 기반 샌드박스를 활용하여 안전하게 코드를 실행하고 파일 시스템을 조작합니다.
*   **웹 브라우징 자동화 에이전트**: 웹사이트를 탐색하며 정보를 수집하는 에이전트가 악성 자바스크립트에 노출되더라도, 격리된 브라우저 환경(Headless Chrome in Docker) 덕분에 호스트 시스템은 안전하게 보호됩니다.

---

## 4. 예상 면접 질문 (Potential Interview Questions)

*   **Q. AI 에이전트 개발 시 샌드박싱을 적용해야 하는 이유는 무엇인가요?**
    *   **A.** AI 에이전트는 LLM의 예측 불가능성과 외부 환경과의 상호작용 때문에 잠재적인 보안 위협을 가집니다. 샌드박싱은 에이전트의 행동 반경을 미리 정의된 안전한 영역으로 제한하여, 악의적이거나 의도치 않은 코드가 시스템에 심각한 손상을 입히는 것을 방지하는 필수적인 보안 장치입니다. 이는 '최소 권한 원칙'을 적용하여 에이전트에게 꼭 필요한 권한만 부여함으로써 시스템의 안정성과 신뢰성을 높입니다.
*   **Q. Docker와 같은 컨테이너 기술이 샌드박싱과 비교했을 때 가지는 장단점은 무엇인가요?**
    *   **A.** 장점으로는 컨테이너가 파일 시스템, 네트워크 등 전체 환경을 격리하므로 더 강력하고 포괄적인 보안 경계를 제공한다는 점입니다. 또한, 애플리케이션의 종속성을 함께 패키징하여 환경의 일관성과 재현성을 보장합니다. 단점으로는 가상 머신보다는 가볍지만, 단순 프로세스 격리 방식의 샌드박스보다는 리소스 오버헤드가 크고 시작 시간이 오래 걸릴 수 있다는 점입니다.
*   **Q. 여러 에이전트를 동시에 실행해야 할 때 어떤 격리 전략을 사용하시겠습니까?**
    *   **A.** 각 에이전트를 별도의 컨테이너에서 실행하는 전략을 선택하겠습니다. 이 방식은 에이전트 간의 상호 간섭(Cross-contamination)을 완벽하게 차단할 수 있습니다. 한 에이전트가 보안에 취약해지거나 비정상적으로 많은 리소스를 사용하더라도 다른 에이전트나 호스트 시스템에 영향을 주지 않습니다. Kubernetes와 같은 컨테이너 오케스트레이션 도구를 함께 사용하면 수많은 에이전트의 생명주기와 리소스를 효율적으로 관리할 수 있습니다.

---

## 5. 더 읽어보기 (Further Reading)

*   [E2B: Open-Source Sandboxes for AI Agents](https://e2b.dev/docs)
*   [Docker Overview](https://docs.docker.com/get-started/overview/)
*   [Sandboxing in Information Security (Wikipedia)](https://en.wikipedia.org/wiki/Sandbox_(computer_security))